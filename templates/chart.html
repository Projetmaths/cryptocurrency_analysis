{% extends "base.html" %}
{% block title %} Cryptotrading {% endblock %}

{% block script %}
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.4/dist/umd/popper.min.js" integrity="sha384-q2kxQ16AaE6UbzuKqyBE9/u/KzioAlnx2maXQHiDX9d4/zp8Ok3f+M7DPm+Ib6IU" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.min.js" integrity="sha384-pQQkAEnwaBkjpqZ8RU1fF1AKtTcHJwFl3pblpTlHXybJjHpMYo79HY3hIi4NKxyj" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.4/dist/Chart.min.js"></script>
<script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
{% endblock %}

{% block link %}
<link rel= "stylesheet" type= "text/css" href= "{{ url_for('static',filename='styles/index.css') }}">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css">
<link rel="shortcut icon" href="{{ url_for('static', filename='favicon.ico') }}">
{% endblock %}

{% block content %}
<div class="content">
	<div class="sidebar">
		<div class="menu">
			<div class="menu-first">
				<div class="menu-title"><i class="fab fa-btc"></i> Cryptocurrency analysis</div>
				<div class="menu-subtitle"><i class="fas fa-tachometer-alt"></i> <a href="/">Dashboard</a></div>
			</div>
			<div class="menu-second">
				<div class="menu-title">Analysis</div>
				<div class="menu-subtitle"><i class="fas fa-chart-bar"></i> <a href="/chart">Charts</a></div>
				<div class="menu-subtitle"><i class="fas fa-table"></i> Tables</div>
			</div>
		</div>
	</div>
	<div class="dashboard">
		<div class="dash-title">Charts</div>
		<div class="dash-datatable">
			<div class="dash-datatable-title"><i class="fas fa-table"></i> DataTable example</div>
			<div class="dash-datatable-container">

				<div style="width: 75%">
					<h2 titre="1">Bitcoin</h2>
					<div graph="1" class="dropdown">
						<canvas id="myChart1"></canvas>
					</div>
				</div>
				<br>

				<div style="width: 75%">
					<h2 titre="2">Ethereum</h2>
					<div graph="2" class="dropdown">
						<canvas id="myChart2"></canvas>
					</div>
				</div>
				<br>

				<!-- <div style="width: 75%">
					<h2 titre="3">Binance Coin</h2>
					<div graph="3" class="dropdown">
						<canvas id="myChart3"></canvas>
					</div>
				</div>
				<br>

				<div style="width: 75%">
					<h2 titre="4">Tether</h2>
					<div graph="4" class="dropdown">
						<canvas id="myChart4"></canvas>
					</div>
				</div>
				<br>

				<div style="width: 75%">
					<h2 titre="5">Cardano</h2>
					<div graph="5" class="dropdown">
						<canvas id="myChart5"></canvas>
					</div>
				</div>
				<br>

				<div style="width: 75%">
					<h2 titre="6">Polkadot</h2>
					<div graph="6" class="dropdown">
						<canvas id="myChart6"></canvas>
					</div>
				</div>
				<br>

				<div style="width: 75%">
					<h2 titre="7">XRP</h2>
					<div graph="7" class="dropdown">
						<canvas id="myChart7"></canvas>
					</div>
				</div>
				<br>

				<div style="width: 75%">
					<h2 titre="8">Uniswap</h2>
					<div graph="8" class="dropdown">
						<canvas id="myChart8"></canvas>
					</div>
				</div>
				<br>

				<div style="width: 75%">
					<h2 titre="9">Litecoin</h2>
					<div graph="9" class="dropdown">
						<canvas id="myChart9"></canvas>
					</div>
				</div>
				<br>

				<div style="width: 75%">
					<h2 titre="10">Chainlink</h2>
					<div graph="10" class="dropdown">
						<canvas id="myChart10"></canvas>
					</div>
				</div>
				<br>

				<div style="width: 75%">
					<h2 titre="11">Bitcoin Cash</h2>
					<div graph="11" class="dropdown">
						<canvas id="myChart11"></canvas>
					</div>
				</div>
				<br>

				<div style="width: 75%">
					<h2 titre="12">Stellar</h2>
					<div graph="12" class="dropdown">
						<canvas id="myChart12"></canvas>
					</div>
				</div>
				<br>

				<div style="width: 75%">
					<h2 titre="13">USD Coin</h2>
					<div graph="13" class="dropdown">
						<canvas id="myChart13"></canvas>
					</div>
				</div>
				<br>

				<div style="width: 75%">
					<h2 titre="14">Wrapped Bitcoin</h2>
					<div graph="14" class="dropdown">
						<canvas id="myChart14"></canvas>
					</div>
				</div>
				<br>

				<div style="width: 75%">
					<h2 titre="15">Dogecoin</h2>
					<div graph="15" class="dropdown">
						<canvas id="myChart15"></canvas>
					</div>
				</div> -->


				<script>
					var labels = {{labels|tojson}};
					var prices = {{data|tojson}};
					var prix_btc_js = {{prix_btc|tojson}};
					var date_btc_js = {{date_btc|tojson}};
					var prix_ada_js = {{prix_ada|tojson}};
					var date_ada_js = {{date_ada|tojson}};
					var prix_bch_js = {{prix_bch|tojson}};
					var date_bch_js = {{date_bch|tojson}};
					var prix_bnb_js = {{prix_bnb|tojson}};
					var date_bnb_js = {{date_bnb|tojson}};
					var prix_doge_js = {{prix_doge|tojson}};
					var date_doge_js = {{date_doge|tojson}};
					var prix_eth_js = {{prix_eth|tojson}};
					var date_eth_js = {{date_eth|tojson}};
					var prix_link_js = {{prix_link|tojson}};
					var date_link_js = {{date_link|tojson}};
					var prix_ltc_js = {{prix_ltc|tojson}};
					var date_ltc_js = {{date_ltc|tojson}};
					var prix_luna_js = {{prix_luna|tojson}};
					var date_luna_js = {{date_luna|tojson}};
					var nb_csv = {{lim}};
					var rows = {{count}};
					var names = {{name|tojson}};
					var symbols = {{symbol|tojson}};
					var nb_lignes = nb_csv*rows;
					var nom_tmp = '';
				
					console.log("==================================================")
					console.log("Paramètres")
					// console.log(rows);
					// console.log(nb_csv);
					// console.log(labels);
					// console.log(prices);
					console.log("==================================================")
				
					
					for (var i = 0; i < (nb_lignes); i++) { //nb_csv*rows donnera le nombre total de lignes présentes à travers tous

						if(i%rows==0){
							console.log("changement"); //Ici on peut séparer les données avec de l'html jsp mais les données dans
													   //le console.log sont bien séparées au modulo du nombre de lignes du csv.
													   //Et vu qu'ils se remplissent à la même vitesse les séparations seront
													   //toujours bien réparties.
							//console.log('---'+names[i],prices[i],i+'---');
					
						}
						
					}
				
					// console.log(tab);
					
						// console.log(i);
						var ctx = document.getElementById('myChart1').getContext('2d');
						var data = {
								labels: [
										{% for label in date_btc %}	
											"{{label}}",
										{% endfor %}
								],
								datasets: [{
									data: [
										  {% for p in prix_btc %}
											  "{{p}}",
										  {% endfor %}
									],
									backgroundColor: [
										'rgba(255, 99, 132, 0.2)',
										
									],

									label: [
										'Prix',
										
									]
								}]
							};
						var config = {
							type: 'bar',
							data: data,
						};
				
						var chart = new Chart(ctx, config);
						//console.log(i)
						
						var ctx = document.getElementById('myChart2').getContext('2d');
						var data = {
								labels: [
										{% for label in date_eth %}	
											"{{label}}",
										{% endfor %}
								],
								datasets: [{
									data: [
										  {% for p in prix_eth %}
											  "{{p}}",
										  {% endfor %}
									],
									backgroundColor: [
										'rgba(255, 159, 64, 0.2)',
									],

									label: [
										'Prix',
										
									]
								}]
							};
						var config = {
							type: 'bar',
							data: data,
						};
				
						var chart = new Chart(ctx, config);
						//console.log(i)
						
				
					$("[titre]").click(function(){
						var affiche = $(this).attr("titre");
						$("[graph='" +affiche+"']").toggle();
					})
				</script>
			</div>
		</div>
	</div>
</div>
{% endblock %}