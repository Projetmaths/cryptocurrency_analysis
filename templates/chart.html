{% extends "base.html" %}
{% block title %} Cryptotrading {% endblock %}

{% block script %}
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.4/dist/umd/popper.min.js" integrity="sha384-q2kxQ16AaE6UbzuKqyBE9/u/KzioAlnx2maXQHiDX9d4/zp8Ok3f+M7DPm+Ib6IU" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.min.js" integrity="sha384-pQQkAEnwaBkjpqZ8RU1fF1AKtTcHJwFl3pblpTlHXybJjHpMYo79HY3hIi4NKxyj" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.4/dist/Chart.min.js"></script>
<script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
{% endblock %}

{% block link %}
<link rel= "stylesheet" type= "text/css" href= "{{ url_for('static',filename='styles/index.css') }}">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css">
<link rel="shortcut icon" href="{{ url_for('static', filename='favicon.ico') }}">
{% endblock %}

{% block content %}
<div class="content">
	<div class="sidebar">
		<div class="menu">
			<div class="menu-first">
				<div class="menu-title"><i class="fab fa-btc"></i> Cryptocurrency analysis</div>
				<div class="menu-subtitle"><i class="fas fa-tachometer-alt"></i> <a href="/">Dashboard</a></div>
			</div>
			<div class="menu-second">
				<div class="menu-title">Analysis</div>
				<div class="menu-subtitle"><i class="fas fa-chart-bar"></i> <a href="/chart">Charts</a></div>
				<div class="menu-subtitle"><i class="fas fa-table"></i> Tables</div>
			</div>
		</div>
	</div>
	<div class="dashboard">
		<div class="dash-title">Charts</div>
		<div class="dash-datatable">
			<div class="dash-datatable-title"><i class="fas fa-table"></i> DataTable example</div>
			<div class="dash-datatable-container">
				<div style="width: 75%">
					<h2>Bitcoin</h2>
					<canvas id="myChart1"></canvas>
				</div>
				<br>
				<div style="width: 75%">
					<h2>Ethereum</h2>
					<canvas id="myChart2"></canvas>
				</div>
				<br>
				<div style="width: 75%">
					<h2>Binance Coin</h2>
					<canvas id="myChart3"></canvas>
				</div>
				<br>
				<div style="width: 75%">
					<h2></h2>Tether
					<canvas id="myChart4"></canvas>
				</div>
				<br>
				<div style="width: 75%">
					<h2>Cardano</h2>
					<canvas id="myChart5"></canvas>
				</div>
				<br>
				<div style="width: 75%">
					<h2>Polkadot</h2>
					<canvas id="myChart6"></canvas>
				</div>
				<br>
				<div style="width: 75%">
					<h2>XRP</h2>
					<canvas id="myChart7"></canvas>
				</div>
				<br>
				<div style="width: 75%">
					<h2>Uniswap</h2>
					<canvas id="myChart8"></canvas>
				</div>
				<br>
				<div style="width: 75%">
					<h2>Litecoin</h2>
					<canvas id="myChart9"></canvas>
				</div>
				<br>
				<div style="width: 75%">
					<h2>Chainlink</h2>
					<canvas id="myChart10"></canvas>
				</div>
				<br>
				<div style="width: 75%">
					<h2>Bitcoin Cash</h2>
					<canvas id="myChart11"></canvas>
				</div>
				<div style="width: 75%">
					<h2>Stellar</h2>
					<canvas id="myChart12"></canvas>
				</div>
				<br>
				<div style="width: 75%">
					<h2>USD Coin</h2>
					<canvas id="myChart13"></canvas>
				</div>
				<br>
				<div style="width: 75%">
					<h2>Wrapped Bitcoin</h2>
					<canvas id="myChart14"></canvas>
				</div>
				<br>
				<div style="width: 75%">
					<h2>Dogecoin</h2>
					<canvas id="myChart15"></canvas>
				</div>
				<script>
					var labels = {{labels|tojson}};
					var prices = {{data|tojson}};
					var nb_csv = {{lim}};
					var rows = {{count}}
					var names = {{name|tojson}};
					var symbols = {{symbol|tojson}};
					var nb_lignes = nb_csv*rows;
					var nom_tmp = ''
				
					console.log("==================================================")
					console.log("Paramètres")
					console.log(rows);
					console.log(nb_csv);
					console.log("==================================================")
				
				
					for (var i = 0; i < (nb_lignes); i++) { //nb_csv*rows donnera le nombre total de lignes présentes à travers tous
															//les csv
						var tab_prix_tmp = []
						var tab_date_tmp = []
						var tab_nom_tmp = []
						if(i%rows==0){
							console.log("changement"); //Ici on peut séparer les données avec de l'html jsp mais les données dans
													   //le console.log sont bien séparées au modulo du nombre de lignes du csv.
													   //Et vu qu'ils se remplissent à la même vitesse les séparations seront
													   //toujours bien réparties.
							//console.log('---'+names[i],prices[i],i+'---');
							nom_tmp = names[i];
						}
						if(nom_tmp==nom_tmp){
							tab_prix_tmp.push(prices[i]);
							tab_date_tmp.push(labels[i]);
							tab_nom_tmp.push(nom_tmp);
						}
						//console.log(names[i],prices[i],i);
						console.log(tab_date_tmp, tab_prix_tmp, tab_nom_tmp);
					}
				
				
					for ( var i = 1 ; i <= (nb_csv) ; i++) {
						//console.log(nom_tmp);
						var ctx = document.getElementById('myChart'+i+'').getContext('2d');
						var data = {
								labels: [
										{% for label in labels %}
											
											"{{ label }}",
										{% endfor %}
								],
								datasets: [{
									label: 'Price',
									data: [
										  {% for prix in data %}
											  {{ prix }},
										  {% endfor %}
									]
								}]};
						var config = {
							type: 'line',
							data: data,
						};
				
						var chart = new Chart(ctx, config);
					}; 	
				
				</script>
			</div>
		</div>
	</div>
</div>
{% endblock %}